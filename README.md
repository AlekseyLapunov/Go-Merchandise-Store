# Merchandise store

Сервис "Магазин мерча" разработан по методологии Domain Driven Design.

# Запуск приложения



# Тестирование

Проект содержит модульные и e2e-тесты.

## Покрытие проекта

Вывод команды `go test ./... -cover` в каталоге исходного кода `src` следующий:

```
?   <snap>src/entity     [no test files]
    <snap>src                            coverage: 0.0% of statements
ok  <snap>src/handler    (cached)        coverage: 69.0% of statements
ok  <snap>src/middleware (cached)        coverage: 44.7% of statements
    <snap>src/mockery                    coverage: 0.0% of statements
ok  <snap>src/storage    (cached)        coverage: 63.5% of statements
ok  <snap>src/usecase    (cached)        coverage: 68.4% of statements
```

Слой `entity` не нуждается в тестах, так содержит только структуры. Пакет `mockery` также не нужно тестировать, так как в нём представлены моки объектов из слоёв `usecase` и `storage`.

Таким образом, если брать в расчёт только тестирование слоёв `handler`, `middleware`, `usecase` и `storage`, то среднее тестовое покрытие составляет `61,4%`.

## Запуск тестов

Запустить модульные тесты с выводом процента покрытия по модулям:

```bash
    $ cd src

    $ go test ./... -cover
```

# Прочие вопросы и решение

Во время разработки появился вопрос: "Может-ли сотрудник отправлять монетки самому себе?" (например, сотрудник `employee` вызывает метод `/api/sendCoin`, в теле запроса указывая при этом себя как получателя).

В требованиях нет запрета на такое действие в явном виде, однако я решил запретить подобное использование метода, так как это бессмыссленное действие, которое, причём, может сильно нагрузить приложение и БД при многократном использовании за короткий промежуток времени.

Итог: сейчас, при попытке сотрудника отправить монетки самому себе, выдаётся ошибка `400 Bad request` с соответствующим сообщением:
```json
{
  "error": "can't send coins to yourself"
}
```
